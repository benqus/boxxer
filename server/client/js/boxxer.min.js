Object.keys===void 0&&(Object.keys=function(e){var t,r=[];for(t in e)e.hasOwnProperty(t)&&r.push(t);return r}),Object.prototype.hasOwnProperty===void 0&&(Object.prototype.hasOwnProperty=function(e){return this[e]&&!this.constructor.prototype[e]}),"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){if("function"!=typeof this)throw new TypeError("Object #<Object> has no method 'bind'");var e=Array.prototype.slice(arguments),t=e.shift(),r=this;return function(){return r.apply(t,e.concat(Array.prototype.slice.call(arguments)))}}),"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(e){for(var t=0,r=this.length;r>t;t++)if(e===this[t])return t;return-1}),function(_g){function Surrogate(){}function debugMode(){return _g.boxxer_debug===!0}function getEventTarget(e){return e.target||e.srcElement}function getBody(){return document.body}function init(e){(e||getBody()).appendChild(renderer)}function getRenderer(){return renderer}function inherit(subClass,superClass){var TemporarySuperClass=function(){};debugMode()&&eval("TemporarySuperClass = function "+subClass.name+"() {};"),TemporarySuperClass.prototype=superClass.prototype,subClass.prototype=new TemporarySuperClass,subClass.prototype.constructor=subClass}function mix(e,t){var r;for(r in t.prototype)t.prototype.hasOwnProperty(r)&&(e.prototype[r]=t.prototype[r])}function register(e,t,r,n){for(var i,o=e.split("."),s=n||boxxer;o.length>0;)i=o.shift(),i&&(s.hasOwnProperty(i)||(s[i]={}),s=s[i]);s[t]="function"==typeof r?r(n||this,s):r}function patch(e,t,r){var n,i=e.split("."),o=r||boxxer;if("function"==typeof t){for(;i.length>0&&o;)n=i.shift(),n&&(o.hasOwnProperty(n)||(o[n]={}),o=o[n]);t(o)}}var boxxer={},renderer=document.createElement("div");renderer.style.display="none",boxxer.register=register,boxxer.Surrogate=Surrogate,boxxer.mix=mix,boxxer.inherit=inherit,boxxer.debugMode=debugMode,boxxer.utils={getBody:getBody,getRenderer:getRenderer,getEventTarget:getEventTarget},debugMode()&&(boxxer.utils.patch=patch),boxxer.init=init,_g.boxxer=boxxer}(window),boxxer.register("view","ViewContainer",function(e){return t=function t(e){this.box=e},t.prototype.render=function(){},t.prototype.serialize=function(){return'""'},e.view.View=t}),boxxer.register("","Dialog",function(e){function t(e,t,r){var n=document.createElement("div");n.style.position="absolute",this.element=n,this.view=e,this.width=0,this.height=0,this.openContext=r||this,this.openCallback=t}return t.prototype.open=function(e,t,r){var n,i=this.element,o=(e||this.view).render(i);i.style.width=(this.width||t)+"px",i.style.height=(this.height||r)+"px","function"==typeof this.openCallback&&this.openCallback.call(this.openContext||this,this),o&&(o instanceof Node?i.appendChild(o):"string"==typeof o&&(n=document.createElement("div"),n.innerHTML=o,i.appendChild(n.firstElementChild)))},e.Dialog=t}),boxxer.register("decorator","Decorator",function(e){function t(){}return t.prototype.engage=function(){return this},t.prototype.getTemplate=function(){return document.createElement("div")},t.registry={},t.isRegistered=function(e){return t.registry.hasOwnProperty(e)},t.getDecorator=function(e){return t.registry[e]},t.extend=function(e){var r,n=new t;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n},t.register=function(e,r){var n,i=t.registry;return""===e||i.hasOwnProperty(e)||(n=t.extend(r),i[e]=n),n},e.decorator.Decorator=t,e.createDecorator=t.register,t}),boxxer.register("mixins","Adjustable",function(e){function t(){}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.setWidth=function(e){this._setElementWidth(parseInt(e))},t.prototype.setHeight=function(e){this._setElementHeight(parseInt(e))},t.prototype.setDimensions=function(e,t){this.setWidth(e),this.setHeight(t)},e.mixins.Adjustable=t,t}),boxxer.register("mixins","ElementWrapper",function(e){function t(){this._element=document.createElement("div")}return t.prototype._setElementWidth=function(e){this.getElement().style.width=e+"px"},t.prototype._setElementHeight=function(e){this.getElement().style.height=e+"px"},t.prototype.getElement=function(){return this._element},t.prototype.addClass=function(e){var t=this.getElement().getAttribute("class"),r=t?t.split(" "):[];0>r.indexOf(e)&&(r.push(e),this.getElement().setAttribute("class",r.join(" ")))},t.prototype.hasClass=function(e){return this.getElement().getAttribute("class").indexOf(e)>-1},t.prototype.getAttribute=function(e){return this.getElement().getAttribute(e)||""},t.prototype.setAttribute=function(e,t){this.getElement().setAttribute(e,""+(t||""))},t.prototype.getDataAttribute=function(e){return this.getElement().getAttribute("data-"+e)},t.prototype.setDataAttribute=function(e,t){this.getElement().setAttribute("data-"+e,t)},t.prototype.text=function(e){var t=this.getElement();return"string"!=typeof e?t.innerText:(t.innerText=e,void 0)},t.prototype.html=function(e){var t=this.getElement();return"string"!=typeof e?t.innerHTML:(t.innerHTML=e,void 0)},e.mixins.ElementWrapper=t,t}),boxxer.register("mixins","ParentElementWrapper",function(e){function t(e){this._parentElement=e}return t.prototype.getParentElement=function(){return this._parentElement||e.utils.getBody()},t.prototype.setParentElement=function(e){var t=this.getElement();t.parentElement!==e&&this._parentElement!==e&&(this._parentElement=e,this._parentElement.appendChild(t))},e.mixins.ParentElementWrapper=t,t}),boxxer.register("mixins","Serializer",function(e){function t(){}return t.prototype.serialize=function(e,r){var n;return n=e===t.JSON?t.toJSON(this,r):t.toXML(this,r)},t.toJSON=function(r,n){var i,o,s=r.view,a=r.getChildCount(),u=r.getDecorators(),h='{"id":'+Number(r.getId().replace("boxxer:box_",""))+","+'"flow":"'+r.getFlowDirection()+'",'+t.getJSONAttributes(r);if("string"==typeof n&&""!==n&&(h+=',"name":"'+n+'"'),u.length>0&&(h+=',"decorators":[',h+=u.join(","),h+="]"),a>0){h+=',"children":[',o=r.getChildren();for(i in o)o.hasOwnProperty(i)&&(h+=o[i].serialize(t.JSON,i),a--,a>0&&(h+=","));h+="]"}return s instanceof e.view.View&&(h+=", view:"+s.serialize()),h+="}"},t.toXML=function(e,r){var n,i,o=e.getDecorators(),s="<boxxer:box id='"+Number(e.getId().replace("boxxer:box_",""))+"'"+" flow='"+e.getFlowDirection()+"'";if("string"==typeof r&&""!==r&&(s+=" name='"+r+"'"),s+=t.getXMLAttributes(e)+">",o.length>0&&(s+=" decorators='",s+=o.join(","),s+="'"),e.getChildCount()){i=e.getChildren();for(n in i)i.hasOwnProperty(n)&&(s+=i[n].serialize(t.XML,n))}return s+="</boxxer:box>"},t.getJSONAttributes=function(e){return'"width":'+e.getWidth().getValue()+","+'"height":'+e.getHeight().getValue()},t.getXMLAttributes=function(e){return" width='"+e.getWidth().getValue()+"' "+"height='"+e.getHeight().getValue()+"'"},t.deserialize=function(e){var r,n,i,o,s;try{i=JSON.parse(e),i instanceof Object&&(s=t.JSON,o=i)}catch(a){r=document.createElement("div"),r.innerHTML=e,n=r.firstElementChild,n&&"boxxer:box"===n.tagName.toLowerCase()&&(s=t.XML,o=n)}return void 0!==o&&(o=t.buildHierarchy(o,s)),o},t.buildHierarchy=function(r,n){var i,o,s,a,u;if(n===t.JSON){if(i=new e.Box,i.setFlowDirection(r.flow),r.width&&i.setWidth(r.width),r.height&&i.setHeight(r.height),r.decorators)for(s=r.decorator.replace(" ","").split(",");s.length>0;)i.addDecorator(s.shift());if(r.children&&r.children.length>0)for(u=0;r.children.length>u;u++)a=r.children[u],o=i.addBox(t.buildHierarchy(a,n),a.name)}else if(n===t.XML){if(i=new e.Box,r.getAttribute("flow")&&i.setFlowDirection(r.getAttribute("flow")),r.getAttribute("width")&&i.setWidthDimension(r.getAttribute("width")),r.getAttribute("height")&&i.setHeightDimension(r.getAttribute("height")),r.getAttribute("decorators"))for(s=r.getAttribute("decorators").replace(" ","").split(",");s.length>0;)i.addDecorator(s.shift());if(r.children&&r.children.length)for(u=0;r.children.length>u;u++)a=r.children[u],o=i.addBox(t.buildHierarchy(a,n),a.getAttribute("name"))}return i},t.XML="xml",t.JSON="json",e.mixins.Serializer=t,t}),boxxer.register("async","Connection",function(e){function t(e,t){this._url=e,this._data=t.data||"",this._callback=t.callback,this._request=new XMLHttpRequest}return t.prototype.onStateChange=function(){var e,t=this._request;"function"==typeof this._callback&&4===t.readyState&&200===t.status&&(e=Array.prototype.slice(arguments),e.unshift(t,t.responseText),this._callback.apply(null,e))},t.prototype.save=function(){this._request.onreadystatechange=this.onStateChange.bind(this),this._request.open(t.POST,this._url,!0),this._request.send()},t.prototype.create=function(){this._request.onreadystatechange=this.onStateChange.bind(this),this._request.open(t.PUT,this._url,!0),this._request.send(this._data)},t.prototype.remove=function(){this._request.onreadystatechange=this.onStateChange.bind(this),this._request.open(t.DELETE,this._url,!0),this._request.send()},t.prototype.get=function(){this._request.onreadystatechange=this.onStateChange.bind(this),this._request.open(t.GET,this._url,!0),this._request.send()},t.PUT="PUT",t.DELETE="DELETE",t.POST="POST",t.GET="GET",e.async.Connection=t,t}),boxxer.register("layouts","Layout",function(e){function t(){}return t.prototype.getLayout=function(){new e.async.Connection(t.URL+"/"+this.getId()).get()},t.prototype.saveLayout=function(r){var n=this.serialize(e.mixins.Serializer.JSON,r||null);new e.async.Connection(t.URL+"/"+this.getId(),{data:n}).save()},t.prototype.deleteLayout=function(){new e.async.Connection(t.URL+this.getId()).remove()},t.URL="http://localhost:666/layout",e.layouts.Layout=t,t}),boxxer.register("events","BoxEvent",function(e){function t(e,r,n){this._eventType=e,this._callback=r,this._context=n,this._muted=!1,this._id="event_"+t._id++}return t.prototype.execute=function(){if(!this.isMuted()){var e=Array.prototype.slice.call(arguments);e.unshift(this.getEventType()),this._callback.apply(this._context,e)}},t.prototype.getId=function(){return this._id},t.prototype.getEventType=function(){return this._eventType},t.prototype.mute=function(){this._muted=!0},t.prototype.unmute=function(){this._muted=!1},t.prototype.isMuted=function(){return this._muted},t._id=0,e.events.BoxEvent=t,t}),boxxer.register("events","EventEmitter",function(e){function t(){this._eventTypes={},this._mutedTypes={}}return t.prototype._createEventType=function(e){return this._eventTypes.hasOwnProperty(e)||(this._eventTypes[e]={}),this._eventTypes[e]},t.prototype.on=function(t,r,n){var i=new e.events.BoxEvent(t,r,n||this);return this._createEventType(t)[i.getId()]=i,i},t.prototype.off=function(t){if(!(t instanceof e.events.BoxEvent))throw new TypeError("Cannot un-register a non-Event type object...");delete this._eventTypes[t.getEventType()][t.getId()]},t.prototype.mute=function(e){this._mutedTypes[e]=!0},t.prototype.unmute=function(e){delete this._mutedTypes[e]},t.prototype.isMuted=function(e){return this._mutedTypes.hasOwnProperty(e)},t.prototype.emit=function(){var e,t,r=Array.prototype.slice.call(arguments),n=r.shift(),i=this._eventTypes[n];if(!this.isMuted(n))for(t in i)i.hasOwnProperty(t)&&(e=i[t],e.execute.apply(e,r))},t.ON_RENDER="render",t.ON_UPDATE="update",e.events.EventEmitter=t,t}),boxxer.register("render","Dimension",function(e){function t(r){var n=this._parse(r),i=parseInt(n.value);switch(this._minValue=e.Box.MIN_DIMENSION,this._value=i?i:1,this._type=void 0,n.type){case"%":this._type=t.PERCENT;break;case"px":this._type=t.PIXEL;break;default:this._type=t.WEIGHT}}return t.prototype._parse=function(e){var t=(""+(e||"")).split(/(\%|px)/);return{value:t[0],type:t[1]}},t.prototype.getType=function(){return this._type},t.prototype.getMinimumValue=function(){return this._minValue},t.prototype.getValue=function(){return this._value},t.prototype.calculate=function(e,r){var n=this.getType(),i=this.getValue(),o=5,s=parseInt(this._parse(this.getMinimumValue()).value),a=i;if(o>=e&&n===t.WEIGHT)a=0;else{switch(n){case t.PERCENT:a=e*(i/100);break;case t.WEIGHT:i>r&&(i=r),a=e/r*i}s>a&&(a=s)}return Math.floor(a)},t.PERCENT="percent",t.WEIGHT="weight",t.DEFAULT_WEIGHT=1,t.PIXEL="pixel",e.render.Dimension=t,t}),boxxer.register("","Box",function(e){function t(r,i,o){n.ElementWrapper.call(this),n.ParentElementWrapper.call(this,o),e.events.EventEmitter.call(this),this._id=t.generateUniqueBoxId(),this._children={},this.view=void 0,this.width=new e.render.Dimension(r),this.height=new e.render.Dimension(i),this._decorators=[],this._flowDirection=t.FLOW_VERTICAL,this._isRendered=!1,this.addClass("boxxer-Box"),this.setDataAttribute("box-id",this.getId()),t._registry[this.getId()]=this}var r="boxxer:box_",n=e.mixins;return e.mix(t,n.Adjustable),e.mix(t,n.ElementWrapper),e.mix(t,n.ParentElementWrapper),e.mix(t,e.layouts.Layout),e.mix(t,n.Serializer),e.mix(t,e.events.EventEmitter),t.prototype.addDecorator=function(e){return this._decorators.push(e),this},t.prototype.getDecorators=function(){return this._decorators},t.prototype.getFlowDirection=function(){return this._flowDirection},t.prototype.setFlowDirection=function(e){this._flowDirection=e},t.prototype.setWidthDimension=function(t){this.width=new e.render.Dimension(t)},t.prototype.setHeightDimension=function(t){this.height=new e.render.Dimension(t)},t.prototype.addChild=function(e,r,n){var i=new t(e,r,this.getElement());return this.addBox(i,n)},t.prototype.addBox=function(e,r){if(!(e instanceof t))throw new TypeError("Argument is not a Box!");return e.setParentElement(this.getElement()),this.getChildren()[r||e.getId()]=e,e},t.prototype.getId=function(){return this._id},t.prototype.getChild=function(e){return this.getChildren()[e]},t.prototype.getChildren=function(){return this._children},t.prototype.getChildCount=function(){return Object.keys(this.getChildren()).length},t.prototype.removeChild=function(e){var t=this.getChildren();t[e].close(),delete t[e]},t.prototype.render=function(){var r,n=this.getParentElement(),i=n.getAttribute("data-box-id"),o=t.getById(i),s=e.events.EventEmitter.ON_RENDER;o instanceof t&&(r=o.getFlowDirection()),e.render.BoxRenderer.render(this,n,r),this._isRendered?s=e.events.EventEmitter.ON_UPDATE:this._isRendered=!0,this.emit(s)},t.MIN_DIMENSION="100px",t.FLOW_VERTICAL="verticalFlow",t.FLOW_HORIZONTAL="horizontalFlow",t._registry={},t._id=0,t.generateUniqueBoxId=function(){return r+t._id++},t.removeBox=function(e){delete t._registry[e]},t.getById=function(e){return t._registry[e]},t.clean=function(){t._id=0,t._registry={}},e.Box=t,t}),boxxer.register("render","BoxRenderer",function(e){function t(){}var r=e.Box,n=e.decorator.Decorator,i=r.FLOW_HORIZONTAL,o=r.FLOW_VERTICAL;return t.prototype.setElementInline=function(e){e.style.display="inline-block",e.style.verticalAlign="top"},t.prototype.render=function(t,r,n){if(!(t instanceof e.Box))throw new TypeError("Invalid argument - not a box!");var i=t.getElement(),o=t.view;n===void 0||r===void 0?(r=t.getParentElement(),n=t.getFlowDirection(),n===e.Box.FLOW_HORIZONTAL&&this.setElementInline(i),t.setDimensions(r.offsetWidth,r.offsetHeight)):n===e.Box.FLOW_HORIZONTAL&&this.setElementInline(i),i.parentNode!==r&&(i.parentNode&&i.parentNode.removeChild(i),r.appendChild(i)),this._applyDecorators(t)._postRender(t,o,i,n)},t.prototype._applyDecorators=function(e){for(var t,r,i=e.getDecorators(),o=i.length,s=0;o>s;s++)t=n.getDecorator(i[s]),r=t.getTemplate(e),t.engage(e,r);return this},t.prototype._postRender=function(t,r,n,i){var o,s;t.getChildCount()&&this._renderChildren(t,n,i),r instanceof e.view.View&&(o=r.render(n),o&&(o instanceof Node?n.appendChild(o):"string"==typeof o&&(s=document.createElement("div"),s.innerHTML=o,n.appendChild(s.firstElementChild))))},t.prototype.resolveAndSortChildren=function(t,r,n){var s,a,u,h=[],p=n===i,c=p?"width":"height",l=r["offset"+(p?"Width":"Height")],d=t.getChildren(),g={},f={},y={},x=0,m=0,b=0;for(u in d)if(d.hasOwnProperty(u)){switch(a=d[u],s=a[c],s.getType()){case e.render.Dimension.PERCENT:f[u]=a,x+=Math.floor(l*(s.getValue()/100));break;case e.render.Dimension.PIXEL:g[u]=a,m+=s.getValue();break;default:y[u]=a,b+=s.getValue()}h.push(u)}return{order:h,method:n===o?"Width":"Height",dimension:n===i?"Width":"Height",pixelBoxes:g,percentBoxes:f,weightBoxes:y,percents:x,weights:b,pixels:m}},t.prototype._renderChildren=function(e,t,r){var n,o,s,a,u,h,p=this.resolveAndSortChildren(e,t,r),c=e.getChildren(),l=p.order;for(r===i?(n=t.offsetHeight,o=t.offsetWidth):(n=t.offsetWidth,o=t.offsetHeight),s=o-p.percents-p.pixels;l.length>0;)h=c[l.shift()],r===i?(a=h.width.calculate(s,p.weights),u=h.height.calculate(n,1)):(a=h.width.calculate(n,1),u=h.height.calculate(s,p.weights)),h.setDimensions(a,u),h.render()},e.render.BoxRenderer=t,new t}),boxxer.createDecorator("DragDecorator",{engage:function(){}}),boxxer.createDecorator("DropDecorator",{engage:function(){}}),boxxer.createDecorator("HeaderDecorator",{engage:function(e,t){var r=e.getElement();r.style.position="relative",r.appendChild(t),console.log(r)},getTemplate:function(e){var t=(document.createElement("h5"),document.createElement("header"));return t.setAttribute("class","HeaderDecorator"),t.innerHTML=e.getId(),t.style.position="absolute",t.style.left="0px",t.style.top="0px",t}}),boxxer.register("decorator","Decorator",function(e){function t(){}return t.prototype.engage=function(){return this},t.prototype.getTemplate=function(){return document.createElement("div")},t.registry={},t.isRegistered=function(e){return t.registry.hasOwnProperty(e)},t.getDecorator=function(e){return t.registry[e]},t.extend=function(e){var r,n=new t;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n},t.register=function(e,r){var n,i=t.registry;return""===e||i.hasOwnProperty(e)||(n=t.extend(r),i[e]=n),n},e.decorator.Decorator=t,e.createDecorator=t.register,t});